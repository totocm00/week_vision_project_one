# ===================================================================
# label_text_recognition 패키지가 공통으로 참조하는 설정 파일입니다.
# ---------------------------------------------------------------
# 이 파일은 배포용 사용자 설정 파일입니다.
# 코드를 수정하지 않고도 카메라, 해상도, OCR 언어, 출력 위치, 부가 기능을
# 한 번에 제어할 수 있습니다.
# 현장 장비나 다른 PC로 옮길 때도 이 파일만 수정하면 됩니다.
# ===================================================================

# ---------------------------------------------------------------
# 📸 1. 카메라 설정
# ---------------------------------------------------------------
camera_index: auto      # auto → 자동 감지 / 숫자(0,1,2...) → 특정 카메라 지정
frame_width: 1280       # 캡처 해상도 (너무 낮으면 OCR 정확도 저하)
frame_height: 720       # 권장 해상도: 1280x720 (720p)

# ---------------------------------------------------------------
# 🌐 2. OCR 언어 설정
# ---------------------------------------------------------------
# PaddleOCR에서 동시에 로드할 언어 목록입니다.
# 첫 번째 항목이 메인 언어로 사용됩니다.
#   - korean : 한글 + 영어 + 숫자 혼용
#   - en     : 영어 전용
ocr_langs:
  - korean
  - en

# ---------------------------------------------------------------
# 💾 3. 출력 경로 설정 (기존 기본 경로)
# ---------------------------------------------------------------
# OCR 수행 결과를 저장할 기본 폴더 경로입니다.
# 각 파일은 타임스탬프(capture_YYYYMMDD_HHMMSS)로 자동 구분됩니다.
# 아래 값들은 export_options 섹션의 기본값과 동일한 의미로 사용됩니다.
output_dir_images: "assets/pictures"               # OCR 결과(박스 포함 이미지)
output_dir_images_origin: "assets/pictures_origin" # 원본 이미지
output_dir_json: "assets/json"                     # OCR 결과 JSON (좌표, 텍스트, confidence)

# ---------------------------------------------------------------
# 🎯 4. OCR 결과 필터링 임계값
# ---------------------------------------------------------------
# OCR confidence(신뢰도) 기준값.
# 높을수록 정확하지만 결과가 적게 나올 수 있습니다.
# 0.5~0.7 권장. 너무 높으면 결과가 거의 없을 수 있습니다.
conf_threshold: 0.5

# ---------------------------------------------------------------
# 🔍 5. 이미지 선명도 기준 (Definition Threshold)
# ---------------------------------------------------------------
# Laplacian variance 값으로 초점 흐림 정도를 판단합니다.
# 값이 높을수록 선명하며, 낮으면 흐립니다.
# 화면에 표시되는 Definition 값이 이 기준보다 낮으면 경고 메시지가 출력됩니다.
definition_threshold: 100

# ---------------------------------------------------------------
# 🧭 6. OCR Classifier (텍스트 방향 보정)
# ---------------------------------------------------------------
# true  → 글자 회전/기울기 자동 보정 (정확도↑, 속도↓)
# false → 보정 비활성화 (속도↑, 정확도↓)
ocr_cls_enable: true

# =====================================================================================
# ⚙️ 7. 기능 토글 (Feature Toggles)
# ---------------------------------------------------------------
# label_text_recognition 내 다양한 부가 기능을
# YAML 설정만으로 켜고 끌 수 있도록 관리합니다.
# true  → 기능 활성화 (ON)
# false → 기능 비활성화 (OFF)
# =====================================================================================

# JSON 기반 OCR 재시각화 기능
# - redraw_from_json.py 와 연계됨
# - true일 경우, OCR 결과(JSON)를 이용해 한글을 PIL로 다시 그려줍니다.
enable_redraw_from_json: true

# 카메라 화면에 실시간 Definition(선명도) 표시
# - true면 좌상단에 Definition 값 출력
enable_definition_overlay: true

# OCR 결과를 터미널(콘솔)에 출력할지 여부
# - true면 인식된 텍스트와 confidence를 로그로 표시
enable_console_log: true

# OCR 결과(이미지/JSON)를 저장할지 여부
# - false로 하면 화면 표시만 하고 파일 저장은 하지 않음
enable_save_output: true

# OCR 처리 중 오류 발생 시 자동 재시도 여부
# - true → 1회 재시도 / false → 즉시 중단
enable_retry_on_error: false

# =====================================================================================
# 👁 8. 시각화 옵션 (실시간 화면 + B박스/좌표 오버레이)
# ---------------------------------------------------------------
# - camera_loop.py 에서 이 값을 읽어:
#     * 카메라 실시간 미리보기 표시 여부
#     * 실시간 B박스 그리기 여부
#     * 실시간 B박스 좌표 텍스트 표시 여부
#   를 제어합니다.
# - 테스트/디버깅 모드에서는 true 로 켜고,
#   성능 측정·배포 모드에서는 false 로 꺼서 가볍게 사용할 수 있습니다.
# =====================================================================================

visualize:
  show_live_preview: true         # true → cv2.imshow()로 실시간 카메라 화면 표시
  draw_bbox_on_live: true         # true → 실시간 화면에 OCR B박스(폴리라인) 그리기
  show_bbox_coords_on_live: true  # true → 각 B박스 옆에 좌표 텍스트까지 함께 표시
  show_definition_on_live: true   # true → Definition(선명도) 값도 함께 오버레이
                                  # (기존 enable_definition_overlay 와 같은 역할, 점진적 이전용)

# =====================================================================================
# 🧾 9. 결과 저장 옵션 (텍스트 JSON / 바운딩 박스 JSON / 디버그 이미지)
# ---------------------------------------------------------------
# - json_exporter.py 에서 이 설정을 읽어 최종 JSON 저장 동작을 결정합니다.
# - camera_loop.py 에서는 debug_image 설정을 읽어
#   "B박스가 그려진 디버그 이미지"를 저장할지 여부를 제어합니다.
#
# - 코드 수정 없이 YAML만으로:
#     1) 어떤 JSON을 만들지 (텍스트 / 바운딩 박스)
#     2) 어디에 저장할지 (폴더)
#     3) 어떤 파일 이름 패턴을 사용할지
#     4) 디버그용 B박스 이미지 저장 여부
#   를 모두 제어할 수 있습니다.
#
# - 좌표 데이터가 필요 없으면 bbox_json.enabled 를 false 로 꺼두면 됩니다.
# - B박스가 그려진 이미지가 필요 없으면 debug_image.enabled 를 false 로 꺼두면 됩니다.
# =====================================================================================

export_options:
  # -------------------------------------------------------------
  # 9-1. 텍스트 JSON 저장 옵션
  # -------------------------------------------------------------
  text_json:
    enabled: true                      # true → 텍스트/신뢰도 JSON 저장, false → 저장 안 함
    path: "assets/json"                # 텍스트 JSON 저장 폴더 (기본값: output_dir_json 과 동일 의미)
    filename_pattern: "capture_{ts}.json"  # {ts} → 타임스탬프 문자열로 자동 치환 예정

  # -------------------------------------------------------------
  # 9-2. 바운딩 박스 JSON 저장 옵션
  # -------------------------------------------------------------
  bbox_json:
    enabled: true                      # true → 바운딩 박스 좌표 JSON 생성, false → 생성 안 함
    path: "assets/json_bbox"           # 바운딩 박스 전용 JSON 저장 폴더
    filename_pattern: "bbox_{ts}.json" # 바운딩 박스 JSON 파일 이름 패턴
    merge_with_text_json: false        # true → 텍스트 JSON 안에 bbox 필드로 합쳐서 한 파일로 저장
                                       # false → 텍스트 JSON과 별도 파일로 분리 저장

  # -------------------------------------------------------------
  # 9-3. 디버그용 시각화 이미지 저장 옵션 (B박스가 그려진 이미지)
  # -------------------------------------------------------------
  debug_image:
    enabled: false                     # true → B박스가 덧그려진 디버그 이미지 저장
    path: "assets/debug_images"        # 디버그 이미지 저장 폴더
    filename_pattern: "debug_{ts}.png" # 디버그 이미지 파일 이름 패턴 ({ts}: 타임스탬프)

# =====================================================================================
# 📘 배포 및 운영 시 권장 가이드
# ---------------------------------------------------------------
# 1. 카메라가 여러 개 → camera_index: auto
# 2. 한글 포함 서류/라벨 → ocr_langs: [korean, en]
# 3. 결과 저장 위치 변경 → output_dir_* 또는 export_options.*.path 항목만 수정
# 4. 테스트 중 과도한 저장 방지 → enable_save_output: false
# 5. 좌표 데이터가 필요 없을 때 → export_options.bbox_json.enabled: false
# 6. 한글이 이미지 위에서 ???? 로 보일 때 → redraw_from_json.py 사용
# 7. 실시간 B박스/좌표가 너무 무겁게 느껴질 때 →
#      visualize.draw_bbox_on_live / show_bbox_coords_on_live 를 false 로 전환
# 8. B박스가 그려진 캡처 이미지만 필요할 때 →
#      visualize.draw_bbox_on_live: true, export_options.debug_image.enabled: true
# ---------------------------------------------------------------
# 주의:
# - 들여쓰기(Indent) 오류 시 YAML 파싱이 실패합니다.
# - 경로는 프로젝트 루트 기준 상대경로를 권장합니다.
# - 새 버전 배포 시 ocr_config.sample.yaml 형태로 템플릿 배포를 추천합니다.
# - 기존 코드와의 호환성을 위해:
#     * output_dir_json 은 여전히 기본 JSON 출력 경로로 사용 가능합니다.
#     * json_exporter.py 에서는 우선 export_options.* 설정을 읽고,
#       설정이 없을 경우 output_dir_json 을 fallback 으로 사용할 수 있습니다.
# =====================================================================================